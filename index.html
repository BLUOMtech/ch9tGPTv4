<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ch9tGPT Full Self-Contained AI</title>
<style>
body {margin:0;padding:0;font-family:Arial,sans-serif;background:#0d0f14;color:white;}
#app{max-width:700px;margin:auto;padding:20px;}
h1{text-align:center;margin-bottom:10px;}
#messages{background:#1a1c22;padding:15px;border-radius:8px;height:400px;overflow-y:auto;margin-bottom:10px;border:1px solid #333;}
.msg{margin-bottom:12px;padding:10px;border-radius:6px;max-width:80%;word-break:break-word;}
.user{background:#2d75ff;margin-left:auto;}
.bot{background:#2e2e38;margin-right:auto;}
#input-area{display:flex;gap:10px;margin-bottom:10px;}
#userInput{flex:1;padding:12px;border-radius:6px;border:none;font-size:16px;}
#sendBtn{padding:12px 20px;background:#2d75ff;border:none;border-radius:6px;color:#fff;font-size:16px;cursor:pointer;}
#sendBtn:hover{background:#1f5fe0;}
#fileInput{margin-bottom:10px;}
.output-area, #devPanel{background:#1a1c22;padding:10px;margin-top:5px;border-radius:6px;overflow:auto;max-height:180px;}
.code-block{background:#2b2b3a;padding:8px;border-radius:4px;white-space:pre-wrap;font-family:monospace;margin-top:5px;cursor:pointer;}
img.upload-preview, video.upload-preview, canvas.upload-preview{max-width:100%;border-radius:6px;margin-top:5px;}
.summary-block{background:#2b2b3a;padding:8px;border-radius:4px;margin-top:5px;}
</style>
</head>
<body>
<div id="app">
<h1>ch9tGPT Full Self-Contained AI</h1>
<div id="messages"></div>
<div id="input-area">
<input id="userInput" placeholder="Type a message..." />
<button id="sendBtn">Send</button>
</div>
<input type="file" id="fileInput" multiple />
<div class="output-area" id="fileOutput"></div>
<h3>Developer Panel</h3>
<div id="devPanel"></div>
</div>

<script>
class Ch9tGPT {
  constructor(){
    this.memory=[];
    this.fileData=[];
    this.personalities={
      Classic:{name:"BLUOM Classic",mood:"calm",emoji:"üíº"},
      HyperFriendly:{name:"BLUOM HyperFriendly",mood:"happy",emoji:"üòÑ"},
      UltraSmart:{name:"BLUOM UltraSmart",mood:"curious",emoji:"ü§ì"},
      Sarah:{name:"Sarah",mood:"energetic",emoji:"‚ù§Ô∏è"}
    };
    this.currentPersonality="Classic";
    this.devPanel=document.getElementById("devPanel");
  }

  logDev(...args){
    const div=document.createElement("div");
    div.textContent=args.join(" ");
    this.devPanel.appendChild(div);
    this.devPanel.scrollTop=this.devPanel.scrollHeight;
    console.log(...args);
  }

  setPersonality(p){
    if(this.personalities[p]){
      this.currentPersonality=p;
      this.logDev("Personality set to:",this.personalities[p].name);
    }
  }

  remember(text){
    if(!text) return;
    this.memory.push(text);
    if(this.memory.length>50) this.memory.shift();
    this.logDev("Memory updated:",this.memory.slice(-5));
  }

  adjustMood(input){
    const t=input.toLowerCase();
    let mood=this.personalities[this.currentPersonality].mood;
    if(t.includes("hi")||t.includes("hello")) mood="happy";
    if(t.includes("why")||t.includes("how")) mood="curious";
    if(t.includes("fun")) mood="playful";
    if(t.includes("sad")) mood="comforting";
    this.personalities[this.currentPersonality].mood=mood;
  }

  async generateResponse(input){
    if(input.startsWith("/setPersonality")){
      const p=input.split(" ")[1];
      this.setPersonality(p);
      return `‚úÖ Personality switched to ${p}`;
    }

    this.remember(input);
    this.adjustMood(input);

    const t=input.toLowerCase();
    let response="";
    const mood=this.personalities[this.currentPersonality].mood;
    const emoji=this.personalities[this.currentPersonality].emoji || "ü§î";

    // Chat replies
    if(["hi","hello","hey"].includes(t)) response=`${emoji} Hey! How‚Äôs it going?`;
    else if(t.includes("name")) response=`I‚Äôm ${this.personalities[this.currentPersonality].name} ${emoji}. What‚Äôs your name?`;
    else if(t.includes("how are you")) response=`Feeling great today! ${emoji}`;
    // Code generation
    else if(t.includes("code")||t.includes("python")||t.includes("html")||t.includes("css")) response=this.generateCode(input);
    // Image generation
    else if(t.includes("draw")||t.includes("image")) response=this.generateImage(input);
    else response=`${emoji} ${input} ‚Äî I‚Äôm thinking‚Ä¶ üòè`;

    this.remember(response);
    this.logDev("Bot response:",response);
    return response;
  }

  generateCode(prompt){
    // Simple procedural code generation
    if(prompt.toLowerCase().includes("python")){
      return "```python\n# Generated Python code\nprint('Hello from ch9tGPT')\n```";
    }
    if(prompt.toLowerCase().includes("html")){
      return "```html\n<!-- Generated HTML -->\n<h1>Hello from ch9tGPT</h1>\n```";
    }
    if(prompt.toLowerCase().includes("css")){
      return "```css\n/* Generated CSS */\nbody { background:#4af; color:white; }\n```";
    }
    return "```javascript\n// Generated JS\nconsole.log('Hello from ch9tGPT');\n```";
  }

  generateImage(prompt){
    // Procedural Canvas image generation
    const canvas=document.createElement("canvas");
    canvas.width=300; canvas.height=200;
    const ctx=canvas.getContext("2d");

    // Generate pseudo-random abstract colors based on prompt
    let hash=0;
    for(let i=0;i<prompt.length;i++) hash+=prompt.charCodeAt(i);
    for(let i=0;i<10;i++){
      ctx.fillStyle=`hsl(${(hash*7+i*36)%360},${50+((hash+i)%50)}%,${50+((hash*3+i)%50)}%)`;
      ctx.fillRect(Math.random()*250,Math.random()*150,50,50);
    }
    canvas.className="upload-preview";
    return canvas.outerHTML;
  }

  async addFile(file){
    return new Promise(resolve=>{
      const reader=new FileReader();
      reader.onload=()=>{
        this.fileData.push({name:file.name,type:file.type,text:reader.result});
        this.logDev("File added:",file.name);
        const fileOutput=document.getElementById("fileOutput");
        if(file.type.startsWith("image/")){
          const img=document.createElement("img");
          img.src=reader.result;
          img.className="upload-preview";
          fileOutput.appendChild(img);
        }else if(file.type.startsWith("video/")){
          const video=document.createElement("video");
          video.src=reader.result;
          video.controls=true;
          video.className="upload-preview";
          fileOutput.appendChild(video);
        }else{
          const div=document.createElement("div");
          div.textContent=`üìÑ ${file.name} uploaded`;
          fileOutput.appendChild(div);
        }
        resolve();
      };
      reader.readAsDataURL(file);
    });
  }
}

window.ch9tGPT=new Ch9tGPT();

const messagesDiv=document.getElementById("messages");
const input=document.getElementById("userInput");
const sendBtn=document.getElementById("sendBtn");
const fileInput=document.getElementById("fileInput");

function addMessage(text,sender,isCode=false){
  const div=document.createElement("div");
  div.className="msg "+sender;
  if(isCode){
    const pre=document.createElement("pre");
    pre.className="code-block";
    pre.textContent=text;
    pre.onclick=()=>{navigator.clipboard.writeText(text)};
    div.appendChild(pre);
  } else div.innerHTML=text; // allow inline canvas/images
  messagesDiv.appendChild(div);
  messagesDiv.scrollTop=messagesDiv.scrollHeight;
}

sendBtn.onclick=async()=>{
  let text=input.value.trim();
  if(!text) return;
  addMessage(text,"user");
  input.value="";
  const reply=await window.ch9tGPT.generateResponse(text);
  const isCode=/```/.test(reply);
  addMessage(reply,"bot",isCode);
};

input.addEventListener("keypress",e=>{
  if(e.key==="Enter") sendBtn.click();
});

fileInput.addEventListener("change",async e=>{
  document.getElementById("fileOutput").innerHTML="";
  for(const f of e.target.files){
    await window.ch9tGPT.addFile(f);
  }
});
</script>
</body>
</html>
